Problem
Read problems statements in mandarin chinese, russian and vietnamese as well.
Chef has teamed up with Batman and Jim Gordon to save Gotham from Joker's plan.

There are initially N police stations each having a unique id and an encryption key.
All stations are connected, using telephone lines, directly or indirectly, to Gordon's police station 
(the one with id R).
In order to provide better protection for all people in Gotham, Batman and Chef have paid for some 
new police stations and come up a smart algorithm to test the security of a particular police station. 

There are Q queries that the two of them perform on Gotham's infrastructure each being either an addition of a new police station or 
a security test, on a particular station, using a key generated by Chef.

Your task is to help our three heroes to perform all the queries succesfully and defeat Joker.

Input
There is only one test case in each test file.
The first line contains two numbers, N and Q, denoting  the number of police stations and 
       the number of queries respectively.
The second line contains two numbers, R and key, denoting the main station's id and 
       its encryption key. 
Each of the next N-1 lines contains three numbers: u, v, k which represent that there is a 
       telephone line from v to u and that u's encryption key is k.
Each of the next Q lines contains a query of form:
 0 v u k: A new station with id u and encryption key k is added and connected by 
                a telephone line to v 
 1 v k: The security test needs two encryption keys a and b such that a minimizes the value of a xor k and b that
               maximizes the value of b xor k. a and b are encryption keys that correspond to some nodes that lie on the path, formed by telephone lines,
               from police station v to Gordon's police station, R.
 The problem requires an online solution. Each query will be encoded using the xor between its real values and the value of the last answer. Please see the note section at the end of the statement to see a piece of code that
shows how the input should be read.
Output
For each operation of type 1, output a single line containing the two requested values (min-value and max-value) separated by a single space.
